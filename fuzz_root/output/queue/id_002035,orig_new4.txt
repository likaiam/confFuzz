CREATE TABLE v0 ( v1 ) ; INSERT INTO v0 VALUES ( 'test' ) ,( 'x' ) ,( 'x' ) ; CREATE TABLE v2 ( v4 , v3 ) ; INSERT INTO v2 VALUES ( '1995-09-01' , 0 ) ,( 'x' , 10 ) ,( 'v1' , 2 ) ,( 'v0' , 2000 ) ; SELECT abs ( max ( v4 ) OVER( ORDER BY v4 ) ) AS AVG_YEARLY FROM v2 GROUP BY v3 ; 