CREATE VIRTUAL TABLE v0 USING rtree ( v3 , v2 , v1 ) ; CREATE VIEW v4 ( v5 ) AS SELECT nth_value ( v2 , 0 ) OVER( ORDER BY v1 ) FROM v0 ; SELECT coalesce ( ( SELECT v5 FROM v4 AS x GROUP BY v5 ) AND 10.100000 , 1 ) FROM v4 ; UPDATE v0 SET v3 = ( SELECT min ( v5 ) FROM v4 WHERE v5 = 10 AND v5 >= 2.100000 ) ; 