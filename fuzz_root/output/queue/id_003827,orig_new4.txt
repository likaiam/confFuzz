CREATE VIRTUAL TABLE v0 USING rtree ( prep_inst , v1 , v2 ) ; CREATE VIEW v3 AS SELECT 10.100000 * SUM ( CASE WHEN ( SELECT 3 ) THEN v1 * ( 10 - v1 ) ELSE 9 END ) FROM v0 ; UPDATE v0 SET v2 = ( SELECT 3 FROM v3 ) ; 