CREATE VIRTUAL TABLE v0 USING rtree ( v3 , v2 , v1 ) ; SELECT DISTINCT v0 . v1 FROM v0 AS a JOIN v0 ON NULL = v0 . v3 WHERE v0 . v2 IN ( v0 . v1 , v0 . v2 , v0 . v3 ) ; SELECT random () % 3 , v1 FROM v0 WHERE min ( v1 , v2 ) ; 