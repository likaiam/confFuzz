CREATE TABLE v0 ( v1 INTEGER CHECK( CASE WHEN v1 != v1 THEN 10 ELSE 10 END ) ) ; CREATE TEMP TRIGGER x BEFORE INSERT ON v0 BEGIN INSERT INTO v0 ( v1 ) SELECT v1 FROM v0 AS PROMO_REVENUE ORDER BY sum ( v1 ) OVER( ) ON CONFLICT DO NOTHING ; END ; VACUUM ; VACUUM ; SELECT * FROM v0 LEFT JOIN v0 ON v1 GLOB 'c' WHERE v1 = 'v0' OR v1 = v0 . v1 ; 