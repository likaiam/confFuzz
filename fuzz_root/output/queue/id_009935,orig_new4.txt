CREATE TABLE v0 ( v1 INTEGER ) ; INSERT INTO v0 ( v1 ) VALUES ( 'MED P' ) ,( 'Brand#34' ) ,( 'v0' ) ,( 'v0' ) ,( 'x' ) ; CREATE VIEW v2 AS SELECT 1.100000 * SUM ( CASE WHEN ( SELECT 3 ) THEN v1 * ( 10 - v1 ) ELSE 2 END ) FROM v0 ; SELECT DISTINCT * FROM v2 AS a JOIN v2 AS AVG_YEARLY ON 10.100000 + 2.100000 JOIN v2 NATURAL JOIN v0 ; SELECT * FROM v0 NATURAL JOIN v0 ORDER BY sum ( - - v1 IS NOT NULL ) OVER( ) DESC ; 