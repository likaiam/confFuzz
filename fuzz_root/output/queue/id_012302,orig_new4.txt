CREATE TABLE v0 ( v6 , v9 INTEGER UNIQUE ON CONFLICT FAIL , v8 INTEGER UNIQUE ON CONFLICT ROLLBACK , v7 INTEGER UNIQUE ON CONFLICT ABORT , v5 INTEGER UNIQUE ON CONFLICT ROLLBACK , v4 INTEGER UNIQUE ON CONFLICT ROLLBACK , v3 UNIQUE , v2 INTEGER PRIMARY KEY ON CONFLICT ROLLBACK , v1 UNIQUE ) ; DELETE FROM v0 WHERE NULL BETWEEN ( SELECT NTILE ( 10 ) OVER( ORDER BY v5 NULLS LAST ) - 1 AS nt FROM v0 ) AND 10 ; CREATE VIEW v10 AS SELECT * FROM v0 WHERE v2 IN ( SELECT v7 FROM v0 ORDER BY v9 LIMIT 10 ) ; SELECT DISTINCT * FROM v10 AS l , v0 AS r , v10 JOIN v10 AS PROMO_REVENUE NATURAL JOIN v0 ; SELECT DISTINCT * FROM v10 , v0 AS PROMO_REVENUE RIGHT OUTER JOIN v0 ON v3 = v9 ; 