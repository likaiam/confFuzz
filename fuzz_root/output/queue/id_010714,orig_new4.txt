CREATE TABLE v0 ( v1 DOUBLE ) ; INSERT INTO v0 ( v1 ) VALUES ( 'v1' ) ,( 'X' ) ,( 's%' ) ,( 'v1' ) ,( 'x' ) ; CREATE VIEW v2 AS SELECT 9223372036854775808.000000 * SUM ( CASE WHEN ( SELECT 0 ) THEN v1 * ( 1 - v1 ) ELSE 0 END ) FROM v0 ; SELECT DISTINCT * FROM v0 AS a JOIN v2 AS AVG_YEARLY ON 10.100000 + 9223372036854775808.000000 JOIN v2 NATURAL JOIN v2 ; SELECT * FROM v2 NATURAL JOIN v0 ORDER BY sum ( - - v1 IS NOT NULL ) OVER( ) DESC ; 