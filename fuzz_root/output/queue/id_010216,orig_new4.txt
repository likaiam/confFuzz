CREATE TABLE v0 ( v1 INT PRIMARY KEY ON CONFLICT REPLACE ) ; CREATE VIRTUAL TABLE v2 USING rtree ( v3 , v5 INTEGER PRIMARY KEY ON CONFLICT ROLLBACK , v4 ) ; UPDATE v2 SET v4 = randomblob ( v5 + v3 ) ; SELECT DISTINCT * FROM v2 AS a JOIN v0 AS AVG_YEARLY ON v2 . v4 = v0 . v1 JOIN v0 NATURAL JOIN v2 ; SELECT * FROM v0 NATURAL JOIN v2 ORDER BY length ( typeof ( v4 ) ) DESC ; 