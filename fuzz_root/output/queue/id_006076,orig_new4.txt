CREATE TABLE v0 ( v1 VARCHAR(1) PRIMARY KEY , v2 INTEGER NOT NULL ) ; SELECT * FROM v0 ORDER BY lead ( v2 IN ( SELECT 0 ) ) OVER( ) DESC , v2 ; SELECT v2 , v1 FROM v0 WHERE v1 IS NOT NULL ; SELECT v2 / v2 , v2 , rank () OVER( ORDER BY v1 DESC ) FROM v0 ORDER BY sum ( v2 ) OVER( ) DESC ; 