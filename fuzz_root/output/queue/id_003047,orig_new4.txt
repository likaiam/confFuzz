CREATE VIRTUAL TABLE v0 USING rtree ( v3 , v2 , v1 ) ; SELECT v3 + 10 FROM v0 INTERSECT SELECT v2 FROM v0 ORDER BY v2 DESC NULLS FIRST LIMIT 10 ; UPDATE v0 SET v3 = ( SELECT 10 FROM v0 GROUP BY nth_value ( v1 , 1 ) OVER( ORDER BY v2 ) ) ; 