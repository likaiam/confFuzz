CREATE VIRTUAL TABLE v0 USING fts4 ( v2 INTEGER AS( nth_value ( v1 , 1 ) OVER( ORDER BY v1 ) + nth_value ( v1 , 10 ) OVER( ) ) , v1 ) ; DELETE FROM v0 WHERE v2 IS NOT NULL OR abs ( v2 ) < 10 ; CREATE TABLE v3 ( v4 PRIMARY KEY ON CONFLICT ROLLBACK UNIQUE UNIQUE NOT NULL ) ; ALTER TABLE v0 RENAME TO v1 ; SELECT v4 , v4 FROM v3 WHERE v4 IS NOT NULL ; 