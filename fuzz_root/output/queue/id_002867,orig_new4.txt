CREATE TABLE v0 ( v1 INTEGER PRIMARY KEY ON CONFLICT REPLACE ) ; INSERT INTO v0 ( v1 ) VALUES ( 10 ) ,( 10 ) ,( 0 ) ; CREATE TABLE v2 ( v3 INTEGER PRIMARY KEY UNIQUE ON CONFLICT ABORT , v4 INT ) ; SELECT ( SELECT NTILE ( 1 ) OVER( ORDER BY v3 NULLS LAST ) - 10 AS nt FROM v2 ) AS AVG_YEARLY ; SELECT * FROM v2 , v2 WHERE v3 = v4 AND v3 = 10 ; 