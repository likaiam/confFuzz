CREATE VIRTUAL TABLE v0 USING rtree ( v1 , v2 , v3 ) ; CREATE VIEW v4 AS SELECT DISTINCT * FROM v0 NATURAL JOIN v0 'v0' ORDER BY v3 DESC , v2 DESC , v2 ; UPDATE v0 SET v1 = ( SELECT 3 FROM v0 LEFT JOIN v4 , v0 , v4 ) ; 