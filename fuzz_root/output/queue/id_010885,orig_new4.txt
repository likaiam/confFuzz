CREATE VIEW v0 AS SELECT ( SELECT DISTINCT 1 ORDER BY random () DESC ) GROUP BY ( random () % 10 ) == 2000 ; WITH tmp AS ( SELECT * FROM v0 ) SELECT * FROM v0 JOIN v0 NATURAL JOIN v0 ; 