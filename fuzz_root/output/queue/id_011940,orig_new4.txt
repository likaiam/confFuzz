CREATE VIRTUAL TABLE v0 USING rtree ( v2 INT , v1 , v3 ) ; INSERT INTO v0 ( v3 ) VALUES ( 10 ) ,( 10 ) ; INSERT INTO v0 ( v3 ) VALUES ( 0.100000 ) ,( 10 ) ,( 3 ) ; SELECT DISTINCT * FROM v0 AS a JOIN v0 AS AVG_YEARLY JOIN v0 NATURAL JOIN v0 ; DELETE FROM v0 WHERE v3 = ( SELECT NTILE ( 10 ) OVER( ORDER BY v3 NULLS LAST ) - 10 AS nt FROM v0 ) OR v1 <= 1 + 0 ; 