CREATE TABLE v0 ( v1 INTEGER PRIMARY KEY ON CONFLICT REPLACE , v2 UNIQUE ) ; DELETE FROM v0 WHERE v2 = 1 OR v2 != lower ( ( SELECT sum ( v2 ) OVER( ORDER BY v1 ) AS xyz FROM v0 ) ) ; SELECT v1 , rank () OVER( ORDER BY v2 DESC ) FROM v0 ORDER BY sum ( v1 ) OVER( ORDER BY v1 ) ; 