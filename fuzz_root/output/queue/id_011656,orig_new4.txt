CREATE TABLE v0 ( v1 INT , v2 FLOAT ) ; INSERT INTO v0 VALUES ( 10 , 3 ) ,( 2 , 0 ) ,( 10 , 0 ) ,( 127 , 9223372036854775807 ) ,( 10 , 10 ) ,( '29' , 10 ) ,( 'v0' , 2 ) ,( 'PROMO%%' , 10 ) ,( 'MED BAG' , 0 ) ,( 'v0' , 10 ) ; SELECT v1 , v2 , dense_rank () OVER( ORDER BY v1 ) , dense_rank () OVER( PARTITION BY v1 ORDER BY v1 ) FROM v0 ; 