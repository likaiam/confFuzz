CREATE TABLE v0 ( v1 ) ; INSERT INTO v0 VALUES ( 'v1' ) ,( 'v1' ) ,( 'v1' ) ; CREATE TABLE v2 ( v4 , v3 INTEGER ) ; INSERT INTO v2 VALUES ( 'v0' , 1 ) ,( 'Al' , 10 ) ,( 'bbbbbbbbaaaaaaaaaaaaaaaaaaaabbbbbbbbaaaaaaaaaaaaaaaaaaaa' , 0 ) ,( 'c' , 10 ) ; SELECT SUM ( DISTINCT v3 * ( 3 - v4 NOT LIKE datetime ( - v3 ) ) ) AS REVENUE , v3 AS alias FROM v2 ; 