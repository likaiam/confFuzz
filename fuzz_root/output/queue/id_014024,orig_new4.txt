CREATE VIRTUAL TABLE v0 USING rtree ( v2 , v1 , v3 ) ; CREATE VIEW v4 AS SELECT CASE WHEN v1 NOT IN ( 2000 , 1 , 3 ) THEN 'v1' ELSE 'v1' END FROM v0 ORDER BY CAST ( v3 AS TEXT ) ; CREATE VIEW v5 AS SELECT SUM ( v2 * ( 10 - 3 ) ) AS REVENUE , v2 AS alias FROM v0 ; ALTER TABLE v0 RENAME TO v2 ; SELECT v10 , v8 FROM v5 WHERE v9 IS NOT NULL ; 