CREATE VIRTUAL TABLE v0 USING rtree ( v2 , v1 , v3 ) ; CREATE VIEW v4 AS SELECT 0.100000 * SUM ( CASE WHEN v1 LIKE '17' THEN v1 * ( 10 - v3 ) ELSE 10 END ) FROM v0 ; CREATE VIEW v8 AS SELECT SUM ( v1 * ( 1 - 10 ) ) AS REVENUE , v3 AS alias FROM v0 ; ALTER TABLE v0 RENAME TO v2 ; SELECT v1 , v1 FROM v0 WHERE v1 IS NOT NULL ; 