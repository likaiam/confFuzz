CREATE VIEW v0 ( v1 ) AS SELECT v1 AS AVG_YEARLY , v1 , v1 , v1 FROM v0 WHERE v1 BETWEEN 'DELIVER IN PERSON' AND 'v1' OR lower ( v1 ) ; CREATE VIEW v2 AS SELECT v1 , sum ( v1 ) OVER( ORDER BY v1 ) AS m FROM v0 ; CREATE VIEW v5 AS SELECT ( SELECT v1 , v1 FROM v0 ) FROM v2 ; CREATE VIEW v7 AS SELECT NTILE ( 1 ) OVER( ORDER BY v8 = ( 2 IN ( 0 , 2 ) ) NULLS LAST ) - 1 AS nt FROM v5 ; SELECT DISTINCT * FROM v7 AS a , v0 AS b , v2 AS c ON NULL = 9223372036854775808.000000 NATURAL JOIN v7 ; 