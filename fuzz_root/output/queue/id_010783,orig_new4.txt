CREATE VIRTUAL TABLE v0 USING fts4 ( v3 AS( - 3.100000 ) , v2 , v1 ) ; INSERT INTO v0 ( v1 ) VALUES ( NULL ) ,( NULL ) ,( 10 ) ,( NULL ) ,( NULL ) ; UPDATE v0 SET v1 = ( SELECT nth_value ( v2 , 10 ) OVER( ORDER BY v3 ) FROM v0 ) WHERE v1 > 10 AND v1 < 10 ; DELETE FROM v0 WHERE ( SELECT DISTINCT 10 AS PROMO_REVENUE FROM v0 LEFT JOIN v0 JOIN v0 , v0 AS PROMO_REVENUE NATURAL JOIN v0 ) ; 