CREATE TABLE v0 ( v1 INTEGER PRIMARY KEY ON CONFLICT REPLACE ) ; INSERT INTO v0 ( v1 ) VALUES ( 1 ) ,( 1 ) ,( 1 ) ; CREATE TABLE v2 ( v6 INTEGER PRIMARY KEY , v4 INTEGER , v5 INTEGER , v3 VARCHAR(255) ) ; SELECT ( SELECT NTILE ( 2 ) OVER( ORDER BY v6 NULLS LAST ) - 10 AS nt FROM v2 ) AS AVG_YEARLY ; SELECT * FROM v0 , v2 WHERE v6 = v4 AND v3 = 2 ; 